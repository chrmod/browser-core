<!DOCTYPE html>
<html>
<head>
	<title>CLIQZ EntitoZaur</title>
	<script type="text/javascript"
	        src='https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/2.0.0/handlebars.js'
	        >
	</script>
    <script id="data_sample_simple" type="text/x-handlebars-template"
>[
    {
        "words": ["hell", "cliqz", "cool"]
    },
    {
        "words": ["result", "two"]
    },
    {
        "words": ["some", "other", "result"]
    }
]</script>
    <script id="hand_sample_simple" type="text/x-handlebars-template"
><div class='master'>
    <hi>HELLO</h1>
    <ol>
        {{#each words}}
            <li>{{this}}</li>
        {{/each}}
    </ol>
</div></script>
    <script id="css_sample_simple" type="text/x-handlebars-template"
>li {
     color: red;
}</script>

    <script id="data_sample_apps" type="text/x-handlebars-template"
>{
    "data": {
        "links": [{
            "background_color_icon": "#A2D5E8",
            "background_color_text": "#83C0D5",
            "icon_url": "http://cdn.cliqz.com/extension/EZ/search/gmail.png",
            "logg_as": "google-gmail",
            "text": "Gmail",
            "url": "https://mail.google.com/"
        }, {
            "background_color_icon": "#FD655A",
            "background_color_text": "#ED4E3B",
            "icon_url": "http://cdn.cliqz.com/extension/EZ/search/calendar.png",
            "logg_as": "google-calendar",
            "text": "Calendar",
            "url": "https://www.google.com/calendar/"
        }, {
            "background_color_icon": "#FEE155",
            "background_color_text": "#FAC30E",
            "icon_url": "http://cdn.cliqz.com/extension/EZ/search/maps.png",
            "logg_as": "google-maps",
            "text": "Maps",
            "url": "https://maps.google.de/"
        }, {
            "background_color_icon": "#FE9965",
            "background_color_text": "#F57037",
            "icon_url": "http://cdn.cliqz.com/extension/EZ/search/news.png",
            "logg_as": "google-news",
            "text": "News",
            "url": "https://news.google.de/"
        }, {
            "background_color_icon": "#94E1BF",
            "background_color_text": "#6BCC9F",
            "icon_url": "http://cdn.cliqz.com/extension/EZ/search/youtube.png",
            "logg_as": "google-youtube",
            "text": "YouTube",
            "url": "https://www.youtube.de/"
        }],
        "logg_action_type": "entity_search_google",
        "only": true,
        "search_box_background_color": "#3E86FC",
        "search_box_icon": "http://cdn.cliqz.com/extension/EZ/search/g_search.png",
        "search_provider": "Google",
        "search_url": "http://www.google.com/search?q=",
        "template": "entity-search-1"
    }
}</script>

    <script id="hand_sample_apps" type="text/x-handlebars-template"
><div class="entity-search-container">
  <!--
  <div class="entity-search-aktuell">
    Aktuell: <span>Ebola</span> <span>Apple Inc.</span> <span>Police</span>
             <span>Tropical cyclones</span> <span>Vladimir Putin</span>
  </div>
  -->
  {{#unless data.no-search-box}}
  <div>
    <div class="entity-search-box" style="border: 1px solid {{data.search_box_background_color}};">
      <img style="background-color: {{data.search_box_background_color}};" id="entity-search-box-icon" src="{{data.search_box_icon}}" />
      <input dont-close="true" type="text" id="entity-search-box-input"
       cliqz-action="stop-click-event-propagation"
       search-url="{{data.search_url}}" search-provider="{{data.search_provider}}"
       logg-action-type="{{data.logg_action_type}}"
       onkeydown="CLIQZ.UI.entitySearchKeyDown(event, this.value, this)"/>
    </div>
  </div>
  {{/unless}}
  <div>
    {{#each data.links}}
      <div class="entity-search-container-app" style="background-color: {{this.background_color_icon}}"
           url="{{this.url}}" type="X" extra="entity-search-{{this.logg_as}}">
        <div><img class="entity-search-app-image" src="{{this.icon_url}}"/></div>
        <div class="entity-search-container-app-text" style="background-color: {{this.background_color_text}};">{{this.text}}</div>
      </div>
    {{/each}}
  </div>
</div>
</script>

    <script id="css_sample_apps" type="text/x-handlebars-template"
>
.entity-search-container {
  padding: 15px;
}

.entity-search-container [url] {
  cursor: pointer;
}

.entity-search-aktuell {
  padding-bottom: 15px;
}

.entity-search-aktuell span{
  padding: 0 13px;
  color: #717171;
}

.entity-search-box {
  border: 1px solid #3E86FC;
  width: 485px;
  height: 30px;
  margin-bottom: 15px;
  background-color: white;
}

#entity-search-box-icon {
  background-color: #3E86FC;
  width: 30px;
  height: 30px;
}

#entity-search-box-input {
  vertical-align: top;
  font-size: 20px;
  width: 440px;
  height: 28px;
  border: none;
}

.entity-search-container-app {
  display: inline-block;
  width: 90px;
  height: 90px;
  border-radius: 5px;
  margin-right: 5px;
}

.entity-search-app-image {
  height: 50px;
}

.entity-search-container-app-text {
  color: white;
  padding: 5px 0;
  border-bottom-right-radius: 5px;
  border-bottom-left-radius: 5px;
}

.entity-search-container-app div {
  margin-top: 15px;
  text-align: center;
}</script>
	<script id="hand_sample_news" type="text/x-handlebars-template"
><div class="entity-search-container">

  <div class="entity-news-title">
    Derzeit aktuell auf
    <span class="" type="X" extra="entity-news-{{domain}}" url="{{url}}">
      {{data.domain}}
    </span>
    <img class="cliqz-logo {{ logo }}" />
  </div>
  <div class="entity-news-stories">
    {{#each data.news}}
      <div class="entity-news-story {{#if @last}} entity-news-story-last {{/if}}"
           url="{{ this.url }}" type="X" extra="entity-news-story">
        <div class="entity-news-story-image">
          <img src="{{ this.thumbnail }}" />
        </div>
        <div class="entity-news-story-description">
          <div class="entity-news-story-title">
            {{ this.title }}
          </div>
          <div class="entity-news-story-time">
            {{ this.time }}
            <span class="entity-news-story-description-text"> {{ this.description }} </span>
          </div>
        </div>
      </div>
    {{/each}}
  </div>

  <div class="entity-news-categories">
      {{#each data.categories}}
        <span url="{{ this.url }}" type="X" extra="entity-news-category">{{ this.title }}</span>
      {{/each}}
  </div>
</div>
</script>
<script id="css_sample_news" type="text/x-handlebars-template"
>.entity-search-container {
  padding: 15px;
}

.entity-news-title {
  color: #414141;
  font-size: 14px;
  margin-bottom: 5px;
}

.entity-news-title span {
  color: #1759a4;
}

.entity-news-title img {
  float: right;
  width: 48px;
  margin: -5px -5px 0 0;
}

.entity-news-story {
  padding: 5px 0;
  border-bottom: 1px solid #DDDDDD;
  max-width: 640px;
  padding-bottom: 8px;
  margin-bottom: 8px;
}

.entity-news-story-last {
  border-bottom: none;
}

.entity-news-story-image img {
  width: 80px;
  height: 50px;
  background-color: #dddddd;
}

.entity-news-story-description {
  vertical-align: top;
  padding: 0 0 0 5px;
}

.entity-news-story-title {
  color: #333333;
  font-size: 14px;
  font-weight: bold;
  max-width: 550px;
  text-overflow: ellipsis;
  white-space: nowrap;
  overflow: hidden;
}

.entity-news-story:hover .entity-news-story-title {
    text-decoration: underline;
}
.entity-news-story-time {
  color: #c92b35;
  text-overflow: ellipsis;
  overflow: hidden;
  max-width: 550px;
  font-size: 14px;
  line-height: 15px;
  height: 30px;
  margin-top: 5px;
}

.entity-news-story-description-text {
  color: #333333;
}

.entity-news-categories {
  color: #437cbc;
  font-size: 14px;
}

.entity-news-categories span{
  padding-right: 15px;
  text-decoration: underline;
}

.entity-news-story-image {
  display: inline-block;
}

.entity-news-story-description {
  display: inline-block;
}
</script>
<script id="data_sample_news" type="text/x-handlebars-template"
>
{
    "q": "faz",
    "url": "http://www.faz.net",
    "data": {
        "news": [{
            "url": "http://www.faz.net/aktuell/politik/nordkoreas-hackerangriff-aus-dem-schatten-des-vaters-13337274.html",
            "description": "Sogar der Verbündete China ist verärgert über Nordkoreas jungen Führer Kim Jong-un. Der Diktator versucht nach dem Hackerangriff, „auf Augenhöhe“ mit ...",
            "title": "Nordkoreas Hackerangriff: Aus dem Schatten des Vaters",
            "thumbnail": "http://cdn.cliqz.com/extension/EZ/news/no-image.svg",
            "time": "vor 16 Minuten"
        }, {
            "url": "http://www.faz.net/aktuell/politik/ausland/afrika/china-sieht-wegen-krieg-in-suedsudan-oelforderung-in-gefahr-13337217.html",
            "description": "Seit mehr als einem Jahr tobt der Krieg in Südsudan. China sieht seine Ölförderung in Gefahr und verlegt 700 Soldaten in das afrikanische Land. Peking...",
            "title": "China verlegt Kampftruppen nach Südsudan",
            "thumbnail": "http://cdn.cliqz.com/extension/EZ/news/no-image.svg",
            "time": "vor 16 Minuten"
        }, {
            "url": "http://www.faz.net/aktuell/sport/mehr-sport/robert-harting-ist-der-richtige-sportler-des-jahres-2014-13337226.html",
            "description": "Ist Robert Hartings Wahl zum Sportler des Jahres wirklich ein „Armutszeugnis“, wie Maria Höfl-Riesch behauptet? Nein. Der Diskuswerfer ist ein Mann de...",
            "title": "Robert Harting ist der richtige Sportler des Jahres",
            "thumbnail": "http://cdn.cliqz.com/extension/EZ/news/no-image.svg",
            "time": "vor 26 Minuten"
        }],
        "only": true,
        "categories": [{
            "url": "http://www.faz.net/aktuell/politik/",
            "title": "Politik"
        }, {
            "url": "http://www.faz.net/aktuell/wirtschaft/",
            "title": "Wirtschaft"
        }, {
            "url": "http://www.faz.net/aktuell/finanzen/",
            "title": "Finanzen"
        }, {
            "url": "http://www.faz.net/aktuell/feuilleton/",
            "title": "Feuilleton"
        }, {
            "url": "http://www.faz.net/aktuell/sport/",
            "title": "Sport"
        }],
        "domain": "faz.net",
        "template": "entity-news-1"
    }
}
</script>
	<style type="text/css">
	body {
		margin: 0 auto;
		max-width: 1540px;
		text-align: center;
		background-color: #f9f9f9;
		padding-bottom: 50px;
	}
	.bx {
		display: inline-block;
		width: 500px;
		margin-right: 10px;
	}
	.ta {
		width: 500px;
		height: 400px;
	}

	.r {
		border: 1px solid #CCC;
		min-height: 100px;
		width: calc(100% - 100px);
		margin: 0px 50px;
        text-align: left;
        background-color: white;
	}
    .res-item {
        border: 1px solid #ccc;
    }

    .button {
      display: inline-block;
      width: 120px;
      height: 32px;
      line-height: 32px;
      border-radius: 2px;
      background-color: #fff;
      color: #646464;
    }

    .button.narrow {
      width: 60px;
    }

    .button.grey {
      background-color: #eee;
    }

    .button.blue {
      background-color: #4285f4;
      color: #fff;
    }

    .button.green {
      background-color: #0f9d58;
      color: #fff;
    }

    .button.raised {
      transition: box-shadow 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      transition-delay: 0.2s;
      box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.26);
    }

    .button.raised:active {
      box-shadow: 0 8px 17px 0 rgba(0, 0, 0, 0.2);
      transition-delay: 0s;
    }
    #error {
        color: red;
    }
	</style>
</head>
<body>
	<h1>Responsive EntityZone Creator</h1>
	<div>
	    <div class="button raised grey narrow"
	         onclick="reset();"
	         >
	         Reset
	    </div>
        <div class="button raised grey narrow"
             onclick="simple();"
             >
             Simple
        </div>
        <div class="button raised grey narrow"
             onclick="news();"
             >
             News
        </div>
        <div class="button raised grey narrow"
             onclick="apps();"
             >
             Apps
        </div>
	    <div class="button raised green narrow"
             onclick='send();'
	         >
	         Send
	    </div>
	</div>
    <div id='feedback'></div>

	<div>
		<div class='bx'>
			<h3>DATA</h3>
			<textarea onkeyup='user_change()' class='ta' id='data'></textarea>
		</div>
		<div class='bx'>
			<h3><a href='http://handlebarsjs.com/' target="_blank">HANDLEBARS</a></h3>
			<textarea onkeyup='user_change()' class='ta' id='hand'></textarea>
		</div>
		<div class='bx'>
			<h3><a href='http://thecodinglove.com/post/105513348037/css' target="_blank">CSS</a></h3>
			<textarea onkeyup='user_change()' class='ta' id='css'></textarea>
		</div>
	</div>

        <br>
    <div class='r' id='res'>
    </div>
	<script type="text/javascript">
		var res = document.getElementById('res'),
			data = document.getElementById('data'),
			hand = document.getElementById('hand'),
			css = document.getElementById('css'),
            feedback = document.getElementById('feedback');

		function init(type, reset){
            var store = JSON.parse(localStorage.cliqz || '[]');
            if(!reset && store.length > 0){
                var last = store[store.length - 1];

                hand.value = last.hand;
                data.value = last.data;
                css.value = last.css;

                try {
                    draw();
                    message('Loaded data from ' + last.date);
                } catch(e){
                    message(e, 'red');
                }

            } else {
                if(type){
                    hand.value = document.getElementById('hand_sample_' + type).innerHTML;
                    data.value = document.getElementById('data_sample_' + type).innerHTML;
                    css.value = document.getElementById('css_sample_' + type).innerHTML;
                } else {
                    hand.value = '';
                    data.value = '';
                    css.value = '';
                }

                try {
                    draw();
                } catch(e){
                    message(e, 'red');
                }
            }
		}

		function reset(){ menu(null); }
        function news() { menu('news'); }
        function apps() { menu('apps'); }
        function simple() { menu('simple'); }

        function menu(type, reset){
            if(confirm('Are you sure? There is no way back!')){
                init(type, true);
            }
        }

        function message(msg, color){
            feedback.value = msg;
            feedback.style.color = color || 'black';
        }
        function user_change(){
            try {
                draw();
            } catch(e){
                message(e, 'red');
            }
        }

		function draw(){
            feedback.value = ""
            save();

            console.log('redrawing ...');

            var d;

            try{
                d = JSON.parse(data.value || '{}')
            } catch(e){
                throw 'invalid data';
            }

            if(document.getElementById('cliqz-style'))
                document.getElementById('cliqz-style').remove();

            var style = document.createElement('style')
            style.type = 'text/css'
            style.innerHTML = css.value;
            style.id = 'cliqz-style';
            document.getElementsByTagName('head')[0].appendChild(style)

            var tpl = hand.value.replace(/&lt;/g, '<').replace(/&gt;/g, '>');

            try{
                if(Array.isArray(d)){
                    var html = ''
                    for(var i in d){
                        html += '<div class="res-item">' + Handlebars.compile(tpl)(d[i]) + '</div>';
                    }
                    res.innerHTML = html;
                } else {
                    res.innerHTML = Handlebars.compile(tpl)(d);
                }
            } catch(e){
                throw 'invalid template';
            }

		}

        function save(){
            var state = JSON.parse(localStorage.cliqz || '[]');
            state.push({
                date: new Date(),
                data: data.value,
                hand: hand.value.replace(/&lt;/g, '<').replace(/&gt;/g, '>'),
                css: css.value
            })

            localStorage.cliqz = JSON.stringify(state.slice(-20));
        }

        function send(){
            window.location.href = 'mailto:?subject=[AUTO] EZ - ' +
                                    '&body=' + encodeURIComponent(
                                        'DATA: \r\n \r\n ' +  data.value +
                                        '\r\n \r\n' +
                                        'HANDLEBARS: \r\n \r\n ' +  hand.innerHTML.replace(/&lt;/g, '<').replace(/&gt;/g, '>') +
                                        '\r\n \r\n' +
                                        'CSS: \r\n \r\n ' +  css.value
                                        );
        }
		init('news', false);
	</script>
</body>
</html>
